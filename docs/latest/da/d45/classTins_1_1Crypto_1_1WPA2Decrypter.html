<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>libtins: Tins::Crypto::WPA2Decrypter Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libtins
   &#160;<span id="projectnumber">4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d36/namespaceTins.html">Tins</a></li><li class="navelem"><b>Crypto</b></li><li class="navelem"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html">WPA2Decrypter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../dc/d5b/classTins_1_1Crypto_1_1WPA2Decrypter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Tins::Crypto::WPA2Decrypter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Decrypts WPA2-encrypted traffic.  
 <a href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../da/da0/crypto_8h_source.html">crypto.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6d64943f944bd64b7955d02bc74585ae"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6d64943f944bd64b7955d02bc74585ae"></a>
typedef <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">HWAddress</a>&lt; 6 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>address_type</b></td></tr>
<tr class="separator:a6d64943f944bd64b7955d02bc74585ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76af801b8e8f55fed2650db99f3c4865"><td class="memItemLeft" align="right" valign="top">typedef std::pair<br class="typebreak"/>
&lt; <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a>, <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865">addr_pair</a></td></tr>
<tr class="memdesc:a76af801b8e8f55fed2650db99f3c4865"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../da/de8/classRepresents.html">Represents</a> a pair of mac addresses.  <a href="#a76af801b8e8f55fed2650db99f3c4865">More...</a><br/></td></tr>
<tr class="separator:a76af801b8e8f55fed2650db99f3c4865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a743290b502d012e5bb02129ab093868e"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865">addr_pair</a>, <br class="typebreak"/>
<a class="el" href="../../d4/dce/classTins_1_1Crypto_1_1WPA2_1_1SessionKeys.html">WPA2::SessionKeys</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a743290b502d012e5bb02129ab093868e">keys_map</a></td></tr>
<tr class="memdesc:a743290b502d012e5bb02129ab093868e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maps an address pair to the session keys.  <a href="#a743290b502d012e5bb02129ab093868e">More...</a><br/></td></tr>
<tr class="separator:a743290b502d012e5bb02129ab093868e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad90089fc6bfeca74b5265e6b10996c4a"><td class="memItemLeft" align="right" valign="top">typedef std::function&lt; void(const <br class="typebreak"/>
std::string &amp;, const <br class="typebreak"/>
<a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a> &amp;)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ad90089fc6bfeca74b5265e6b10996c4a">ap_found_callback_type</a></td></tr>
<tr class="memdesc:ad90089fc6bfeca74b5265e6b10996c4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type used to store the callback type used when a new access point is found.  <a href="#ad90089fc6bfeca74b5265e6b10996c4a">More...</a><br/></td></tr>
<tr class="separator:ad90089fc6bfeca74b5265e6b10996c4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac390dbe678cb04e2bf8f35f2ab1408d9"><td class="memItemLeft" align="right" valign="top">typedef std::function&lt; void(const <br class="typebreak"/>
std::string &amp;, const <br class="typebreak"/>
<a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a> &amp;, const <br class="typebreak"/>
<a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a> &amp;)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ac390dbe678cb04e2bf8f35f2ab1408d9">handshake_captured_callback_type</a></td></tr>
<tr class="separator:ac390dbe678cb04e2bf8f35f2ab1408d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa43511842ded844df373c10c44be9a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#aa43511842ded844df373c10c44be9a1e">add_ap_data</a> (const std::string &amp;psk, const std::string &amp;ssid)</td></tr>
<tr class="memdesc:aa43511842ded844df373c10c44be9a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an access points's information.  <a href="#aa43511842ded844df373c10c44be9a1e">More...</a><br/></td></tr>
<tr class="separator:aa43511842ded844df373c10c44be9a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27e4be9c6469ea3a0e5be6acac8909de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a27e4be9c6469ea3a0e5be6acac8909de">add_ap_data</a> (const std::string &amp;psk, const std::string &amp;ssid, const <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a> &amp;addr)</td></tr>
<tr class="memdesc:a27e4be9c6469ea3a0e5be6acac8909de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a access points's information, including its BSSID.  <a href="#a27e4be9c6469ea3a0e5be6acac8909de">More...</a><br/></td></tr>
<tr class="separator:a27e4be9c6469ea3a0e5be6acac8909de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae027629acfe050af8f8928a2c26d7087"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ae027629acfe050af8f8928a2c26d7087">add_decryption_keys</a> (const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865">addr_pair</a> &amp;addresses, const <a class="el" href="../../d4/dce/classTins_1_1Crypto_1_1WPA2_1_1SessionKeys.html">WPA2::SessionKeys</a> &amp;session_keys)</td></tr>
<tr class="memdesc:ae027629acfe050af8f8928a2c26d7087"><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicitly add decryption keys.  <a href="#ae027629acfe050af8f8928a2c26d7087">More...</a><br/></td></tr>
<tr class="separator:ae027629acfe050af8f8928a2c26d7087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdf7d1f0c5e306b56ca259630301d760"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#abdf7d1f0c5e306b56ca259630301d760">decrypt</a> (<a class="el" href="../../d8/de6/classTins_1_1PDU.html">PDU</a> &amp;pdu)</td></tr>
<tr class="memdesc:abdf7d1f0c5e306b56ca259630301d760"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts the provided <a class="el" href="../../d8/de6/classTins_1_1PDU.html" title="Base class for protocol data units. ">PDU</a>.  <a href="#abdf7d1f0c5e306b56ca259630301d760">More...</a><br/></td></tr>
<tr class="separator:abdf7d1f0c5e306b56ca259630301d760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa79710c10e842c49966ed8e7bc829b8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#aa79710c10e842c49966ed8e7bc829b8e">handshake_captured_callback</a> (const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ac390dbe678cb04e2bf8f35f2ab1408d9">handshake_captured_callback_type</a> &amp;callback)</td></tr>
<tr class="memdesc:aa79710c10e842c49966ed8e7bc829b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the handshake captured callback.  <a href="#aa79710c10e842c49966ed8e7bc829b8e">More...</a><br/></td></tr>
<tr class="separator:aa79710c10e842c49966ed8e7bc829b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aade32f28c703b7b4cdb73cccfcc91583"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#aade32f28c703b7b4cdb73cccfcc91583">ap_found_callback</a> (const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ad90089fc6bfeca74b5265e6b10996c4a">ap_found_callback_type</a> &amp;callback)</td></tr>
<tr class="memdesc:aade32f28c703b7b4cdb73cccfcc91583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the access point found callback.  <a href="#aade32f28c703b7b4cdb73cccfcc91583">More...</a><br/></td></tr>
<tr class="separator:aade32f28c703b7b4cdb73cccfcc91583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4edf4607641dcd5aee5d97c2eccd0e1"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a743290b502d012e5bb02129ab093868e">keys_map</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ab4edf4607641dcd5aee5d97c2eccd0e1">get_keys</a> () const </td></tr>
<tr class="memdesc:ab4edf4607641dcd5aee5d97c2eccd0e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the keys on this decrypter.  <a href="#ab4edf4607641dcd5aee5d97c2eccd0e1">More...</a><br/></td></tr>
<tr class="separator:ab4edf4607641dcd5aee5d97c2eccd0e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Decrypts WPA2-encrypted traffic. </p>
<p>This class takes valid PSK and SSID tuples, captures client handshakes, and decrypts their traffic afterwards. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a76af801b8e8f55fed2650db99f3c4865"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::pair&lt;<a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a>, <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a>&gt; <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865">Tins::Crypto::WPA2Decrypter::addr_pair</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="../../da/de8/classRepresents.html">Represents</a> a pair of mac addresses. </p>
<p>This is used to identify a host and the access point to which it is connected. The first element in the pair will always de lower or equal than the second one, so that given any host and the access point it's connected to, we can uniquely identify it with an address pair. </p>

</div>
</div>
<a class="anchor" id="ad90089fc6bfeca74b5265e6b10996c4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::function&lt;void(const std::string&amp;, const <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a>&amp;)&gt; <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ad90089fc6bfeca74b5265e6b10996c4a">Tins::Crypto::WPA2Decrypter::ap_found_callback_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The type used to store the callback type used when a new access point is found. </p>
<p>The first argument to the function will be the access point's SSID and the second one its BSSID. </p>

</div>
</div>
<a class="anchor" id="ac390dbe678cb04e2bf8f35f2ab1408d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::function&lt;void(const std::string&amp;, const <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a>&amp;, const <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a>&amp;)&gt; <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ac390dbe678cb04e2bf8f35f2ab1408d9">Tins::Crypto::WPA2Decrypter::handshake_captured_callback_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The type used to store the callback type used when a new handshake is captured.</p>
<p>The first argument to the function will be the access point's SSID and the second one its BSSID. The third argument will be the client's hardware address. </p>

</div>
</div>
<a class="anchor" id="a743290b502d012e5bb02129ab093868e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;<a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865">addr_pair</a>, <a class="el" href="../../d4/dce/classTins_1_1Crypto_1_1WPA2_1_1SessionKeys.html">WPA2::SessionKeys</a>&gt; <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a743290b502d012e5bb02129ab093868e">Tins::Crypto::WPA2Decrypter::keys_map</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maps an address pair to the session keys. </p>
<p>This type associates an address pair (host, access point) with the session keys, as generated using the packets seen on a handshake.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865" title="Represents a pair of mac addresses. ">addr_pair</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa43511842ded844df373c10c44be9a1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Tins::Crypto::WPA2Decrypter::add_ap_data </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ssid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds an access points's information. </p>
<p>This associates an SSID with a PSK, and allows the decryption of any BSSIDs that broadcast the same SSID.</p>
<p>The decrypter will inspect beacon frames, looking for SSID tags that contain the given SSID.</p>
<p>Note that using this overload, the decryption of data frames and handshake capturing will be disabled until any access point broadcasts the provided SSID(this shouldn't take long at all). If this is not the desired behaviour, then you should check out the ovther add_ap_data overload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psk</td><td>The PSK associated with the SSID. </td></tr>
    <tr><td class="paramname">ssid</td><td>The network's SSID. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a27e4be9c6469ea3a0e5be6acac8909de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Tins::Crypto::WPA2Decrypter::add_ap_data </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ssid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dc/da6/classTins_1_1HWAddress.html">address_type</a> &amp;&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a access points's information, including its BSSID. </p>
<p>This overload can be used if the BSSID associated with this SSID is known beforehand. The addr parameter indicates which specific BSSID is associated to the SSID.</p>
<p>Note that if any other access point broadcasts the provided SSID, it will be taken into account as well.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psk</td><td>The PSK associated with this SSID. </td></tr>
    <tr><td class="paramname">ssid</td><td>The network's SSID. </td></tr>
    <tr><td class="paramname">addr</td><td>The access point's BSSID. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae027629acfe050af8f8928a2c26d7087"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Tins::Crypto::WPA2Decrypter::add_decryption_keys </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a76af801b8e8f55fed2650db99f3c4865">addr_pair</a> &amp;&#160;</td>
          <td class="paramname"><em>addresses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dce/classTins_1_1Crypto_1_1WPA2_1_1SessionKeys.html">WPA2::SessionKeys</a> &amp;&#160;</td>
          <td class="paramname"><em>session_keys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Explicitly add decryption keys. </p>
<p>This method associates a pair (host, access point) with the given decryption keys. All encrypted packets sent between the given addresses will be decrypted using the provided keys.</p>
<p>This method shouldn't normally be required. The <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html" title="Decrypts WPA2-encrypted traffic. ">WPA2Decrypter</a> will be waiting for handshakes and will automatically extract the session keys, decrypting all encrypted packets with them. You should only use this method if for some reason you know the actual keys being used (because you checked and stored the keys_map somewhere).</p>
<p>The actual order of the addresses doesn't matter, this method will make sure they're sorted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addresses</td><td>The address pair (host, access point) to associate. </td></tr>
    <tr><td class="paramname">session_keys</td><td>The keys to use when decrypting messages sent between the given addresses. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aade32f28c703b7b4cdb73cccfcc91583"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Tins::Crypto::WPA2Decrypter::ap_found_callback </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ad90089fc6bfeca74b5265e6b10996c4a">ap_found_callback_type</a> &amp;&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the access point found callback. </p>
<p>This callback will be executed every time a new access point is found, that's advertising an SSID added when calling add_ap_data.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ad90089fc6bfeca74b5265e6b10996c4a" title="The type used to store the callback type used when a new access point is found. ">ap_found_callback_type</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The new callback to be set </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="abdf7d1f0c5e306b56ca259630301d760"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Tins::Crypto::WPA2Decrypter::decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/de6/classTins_1_1PDU.html">PDU</a> &amp;&#160;</td>
          <td class="paramname"><em>pdu</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts the provided <a class="el" href="../../d8/de6/classTins_1_1PDU.html" title="Base class for protocol data units. ">PDU</a>. </p>
<p>A <a class="el" href="../../d4/d3e/classTins_1_1Dot11Data.html" title="Represents an IEEE 802.11 data frame. ">Dot11Data</a> <a class="el" href="../../d8/de6/classTins_1_1PDU.html" title="Base class for protocol data units. ">PDU</a> is looked up inside the provided <a class="el" href="../../d8/de6/classTins_1_1PDU.html" title="Base class for protocol data units. ">PDU</a> chain. If no such <a class="el" href="../../d8/de6/classTins_1_1PDU.html" title="Base class for protocol data units. ">PDU</a> exists or no PSK was associated with the SSID broadcasted by the <a class="el" href="../../d8/df1/classTins_1_1Dot11.html" title="Class representing an 802.11 frame. ">Dot11</a> packet's BSSID, or no <a class="el" href="../../d5/ddb/classTins_1_1EAPOL.html" title="Represents the EAP encapsulation over LAN. ">EAPOL</a> handshake was captured for the client involved in the communication, then the <a class="el" href="../../d8/de6/classTins_1_1PDU.html" title="Base class for protocol data units. ">PDU</a> is left intact.</p>
<p>Otherwise, the packet is decrypted using the generated PTK. If the resulting MIC is invalid, then the packet is left intact.</p>
<dl class="section return"><dt>Returns</dt><dd>false if no decryption was performed, or the decryption failed, true otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="ab4edf4607641dcd5aee5d97c2eccd0e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#a743290b502d012e5bb02129ab093868e">keys_map</a>&amp; Tins::Crypto::WPA2Decrypter::get_keys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the keys on this decrypter. </p>
<p>The returned map will be populated every time a new, complete, handshake is captured.</p>
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html" title="Decrypts WPA2-encrypted traffic. ">WPA2Decrypter</a> keys map. </dd></dl>

</div>
</div>
<a class="anchor" id="aa79710c10e842c49966ed8e7bc829b8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Tins::Crypto::WPA2Decrypter::handshake_captured_callback </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ac390dbe678cb04e2bf8f35f2ab1408d9">handshake_captured_callback_type</a> &amp;&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the handshake captured callback. </p>
<p>This callback will be executed every time a new handshake is captured.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="../../da/d45/classTins_1_1Crypto_1_1WPA2Decrypter.html#ac390dbe678cb04e2bf8f35f2ab1408d9">handshake_captured_callback_type</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The new callback to be set </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/matias/Projects/libtins/code/include/tins/<a class="el" href="../../da/da0/crypto_8h_source.html">crypto.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Aug 5 2017 19:21:51 for libtins by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
